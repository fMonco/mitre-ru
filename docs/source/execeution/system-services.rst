





Системные услуги
=======================

Злоумышленники могут злоупотреблять системными службами или демонами для выполнения команд или программ. Злоумышленники могут выполнять вредоносное содержимое, взаимодействуя с сервисами или создавая их локально или удаленно. Многие службы настроены на запуск при загрузке, что может помочь в достижении постоянства (Create or Modify System Process), но злоумышленники также могут использовать службы для одноразового или временного выполнения.







Launchctl
------------------------------------------------------------------------

Злоумышленники могут использовать launchctl для выполнения команд или программ. Launchctl взаимодействует с launchd, фреймворком управления сервисами для macOS. Launchctl поддерживает прием подкоманд из командной строки, в интерактивном режиме или даже перенаправление из стандартного ввода[1].

Злоумышленники используют launchctl для выполнения команд и программ в качестве агентов запуска или демонов запуска. Общие подкоманды включают: launchctl load, launchctl unload и launchctl start. Злоумышленники могут использовать скрипты или вручную выполнять команды launchctl load -w "%s/Library/LaunchAgents/%s" или /bin/launchctl load для выполнения Launch Agents или Launch Daemons.[2][3]








Выполнение служб
------------------------------------------------------------------------

Злоумышленники могут использовать диспетчер управления службами Windows для выполнения вредоносных команд или полезной нагрузки. Диспетчер управления службами Windows (services.exe) - это интерфейс для управления и манипулирования службами.[1] Диспетчер управления службами доступен пользователям через компоненты графического интерфейса, а также системные утилиты, такие как sc.exe и Net.

PsExec также можно использовать для выполнения команд или полезной нагрузки через временную службу Windows, созданную с помощью API диспетчера управления службами.[2] Такие инструменты, как PsExec и sc.exe, могут принимать удаленные серверы в качестве аргументов и использоваться для удаленного выполнения.

Злоумышленники могут использовать эти механизмы для выполнения вредоносного содержимого. Это может быть сделано путем выполнения новой или модифицированной службы. Эта техника используется вместе со службой Windows при сохранении службы или повышении привилегий.