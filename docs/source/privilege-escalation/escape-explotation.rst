





Побег к Хосту
----------------------------------------------------------------------------

Злоумышленники могут вырваться из контейнера, чтобы получить доступ к базовому хосту. Это может позволить злоумышленнику получить доступ к другим контейнеризированным ресурсам с уровня хоста или к самому хосту. В принципе, контейнерные ресурсы должны обеспечивать четкое разделение функциональности приложений и быть изолированными от среды хоста.

Существует множество способов, с помощью которых злоумышленник может проникнуть в среду хоста. В качестве примера можно привести создание контейнера, настроенного на монтирование файловой системы хоста с помощью параметра bind, что позволяет злоумышленнику сбрасывать полезную нагрузку и выполнять на хосте управляющие утилиты, такие как cron; использование контейнера с привилегиями для выполнения команд или загрузки вредоносного модуля ядра на базовый хост; или злоупотребление системными вызовами, такими как unshare и keyctl, для повышения привилегий и кражи секретов.

Кроме того, противник может использовать взломанный контейнер с подключенным сокетом управления контейнером, например docker.sock, для выхода из контейнера с помощью команды администрирования контейнера. Противники могут также использовать расширение привилегий, например, используя уязвимости в глобальных символических ссылках для получения доступа к корневому каталогу хост-машины.

Получение доступа к хосту может дать противнику возможность достичь последующих целей, таких как создание устойчивости, перемещение в среде или создание командно-контрольного канала на хосте.





Эксплуатация для повышения привилегий
----------------------------------------------------------------------------

Злоумышленники могут использовать уязвимости в программном обеспечении, пытаясь повысить уровень привилегий. Эксплуатация программной уязвимости происходит, когда противник использует ошибку в программе, службе или в самом программном обеспечении или ядре операционной системы для выполнения контролируемого противником кода. Конструкции безопасности, такие как уровни разрешений, часто препятствуют доступу к информации и использованию определенных методов, поэтому противникам, скорее всего, придется выполнять повышение привилегий, включая использование эксплуатации программного обеспечения, чтобы обойти эти ограничения.

При первоначальном получении доступа к системе противник может работать в рамках процесса с более низкими привилегиями, что не позволит ему получить доступ к определенным ресурсам системы. Могут существовать уязвимости, обычно в компонентах операционной системы и программном обеспечении, обычно работающем с более высокими правами доступа, которые можно использовать для получения более высокого уровня доступа к системе. Это может позволить кому-то перейти от непривилегированных прав или прав пользователя к правам SYSTEM или root в зависимости от уязвимого компонента. Это также может позволить злоумышленнику перейти из виртуализированной среды, например, внутри виртуальной машины или контейнера, на основной хост. Это может быть необходимым шагом для злоумышленника, компрометирующего конечную систему, которая была правильно настроена и ограничивает другие методы повышения привилегий.

Злоумышленники могут перенести подписанный уязвимый драйвер на взломанную машину, чтобы использовать уязвимость для выполнения кода в режиме ядра. Этот процесс иногда называют Bring Your Own Vulnerable Driver. Злоумышленники могут включить уязвимый драйвер в файлы, предоставляемые при первоначальном доступе, или загрузить его на взломанную систему с помощью Ingress Tool Transfer или Lateral Tool Transfer.