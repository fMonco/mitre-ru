

Формирование учетных данных в Интернете
==============================================


Злоумышленники могут подделать учетные данные, которые можно использовать для получения доступа к веб-приложениям или интернет-сервисам. Веб-приложения и сервисы часто используют сеансовые файлы cookie, маркеры или другие материалы для аутентификации и авторизации доступа пользователей.

Злоумышленники могут генерировать эти учетные данные, чтобы получить доступ к веб-ресурсам. Этот способ отличается от Steal Web Session Cookie, Steal Application Access Token и других подобных тем, что учетные данные создаются и подделываются злоумышленником, а не крадутся или перехватываются у легитимных пользователей.

Для создания веб-учетных данных часто требуются секретные значения, такие как пароли, личные ключи или другие криптографические начальные значения. Злоумышленники также могут подделывать токены, пользуясь такими функциями, как API AssumeRole и GetFederationToken в AWS, которые позволяют пользователям запрашивать временные учетные данные безопасности, или командой zmprov gdpak в Zimbra, которая генерирует ключ предварительной аутентификации, который можно использовать для генерации токенов для любого пользователя в домене.

После подделки противники могут использовать эти веб-учетные данные для доступа к ресурсам, что позволяет обойти многофакторную и другие механизмы защиты аутентификации.


Веб-куки
----------------------------------------------------------------------------


Злоумышленники могут подделывать веб-куки, которые можно использовать для получения доступа к веб-приложениям или интернет-сервисам. Веб-приложения и службы часто используют сеансовые файлы cookie для аутентификации и авторизации пользователей.

Злоумышленники могут генерировать эти файлы cookie, чтобы получить доступ к веб-ресурсам. Этот способ отличается от Steal Web Session Cookie и других подобных тем, что файлы cookie создаются и подделываются злоумышленником, а не крадутся или перехватываются у легитимных пользователей. Большинство распространенных веб-приложений имеют стандартизированные и документированные значения cookie, которые можно генерировать с помощью предоставляемых инструментов или интерфейсов. Для генерации веб-куки часто требуются секретные значения, такие как пароли, личные ключи или другие криптографические начальные значения.

После подделки злоумышленники могут использовать эти веб-куки для доступа к ресурсам, что позволяет обойти многофакторные и другие механизмы защиты аутентификации.


Токены SAML
----------------------------------------------------------------------------


Противник может подделать SAML-токены с любыми требованиями к разрешениям и сроками действия, если у него есть действительный сертификат подписи SAML-токена. По умолчанию срок действия SAML-токена составляет один час, но период действия может быть указан в значении NotOnOrAfter элемента conditions ... в токене. Это значение можно изменить с помощью параметра AccessTokenLifetime в LifetimeTokenPolicy. Поддельные SAML-токены позволяют злоумышленникам проводить аутентификацию в службах, использующих SAML 2.0 в качестве механизма SSO.

Злоумышленник может использовать личные ключи для компрометации сертификата организации, подписывающего токены, чтобы создать поддельные токены SAML. Если у злоумышленника достаточно прав для установления нового доверия федерации с собственным сервером Active Directory Federation Services, он может вместо этого сгенерировать собственный доверенный сертификат подписания токенов. Это отличается от Steal Application Access Token и других подобных действий тем, что токены создаются и подделываются злоумышленником, а не крадутся или перехватываются у легитимных пользователей.

Злоумышленник может получить административные привилегии Azure AD, если подделать токен SAML, который утверждает, что представляет высокопривилегированную учетную запись. Это может привести к использованию альтернативного материала аутентификации, который может обойти многофакторные и другие механизмы защиты аутентификации.