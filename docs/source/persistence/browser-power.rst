




Расширения для браузеров
-------------------------------------------------


Злоумышленники могут использовать расширения интернет-браузеров для получения постоянного доступа к системам жертв. Расширения или плагины для браузеров - это небольшие программы, которые могут добавлять функциональность и настраивать различные аспекты работы интернет-браузеров. Они могут быть установлены напрямую или через магазин приложений браузера и, как правило, имеют доступ и разрешения ко всему, что доступно браузеру.

Вредоносные расширения могут быть установлены в браузер через вредоносные загрузки из магазина приложений, маскирующиеся под легитимные расширения, с помощью социальной инженерии или злоумышленниками, уже взломавшими систему. Безопасность магазинов приложений для браузеров может быть ограничена, поэтому вредоносным расширениям несложно обойти автоматические сканеры. В зависимости от браузера злоумышленники могут также манипулировать url-адресом обновления расширения для установки обновлений с контролируемого злоумышленниками сервера или манипулировать файлом конфигурации мобильного устройства для тихой установки дополнительных расширений.

До macOS 11 злоумышленники могли бесшумно устанавливать расширения браузера через командную строку, используя инструмент profiles для установки вредоносных файлов .mobileconfig. В macOS 11+ использование инструмента profiles больше не позволяет устанавливать профили конфигурации, однако файлы .mobileconfig могут быть подложены и установлены без участия пользователя.

После установки расширения оно может просматривать веб-сайты в фоновом режиме, красть всю информацию, которую пользователь вводит в браузер (включая учетные данные), и использоваться в качестве установщика RAT для сохранения данных.

Известны случаи, когда ботнеты использовали постоянный бэкдор через вредоносные расширения Chrome. Также были примеры использования расширений для управления и контроля.







Двоичные файлы клиентского программного обеспечения Compromise
-------------------------------------------------


Злоумышленники могут модифицировать двоичные файлы клиентского ПО, чтобы получить постоянный доступ к системам. Клиентское программное обеспечение позволяет пользователям получать доступ к услугам, предоставляемым сервером. К распространенным типам клиентского ПО относятся клиенты SSH, FTP-клиенты, клиенты электронной почты и веб-браузеры.

Злоумышленники могут вносить изменения в двоичные файлы клиентского ПО, чтобы выполнять вредоносные задачи, когда эти приложения используются. Например, злоумышленник может скопировать исходный код клиентского ПО, добавить бэкдор, скомпилировать его для целевой задачи и заменить бинарную версию легитимного приложения (или файлы поддержки) на бэкдорную. Противник также может модифицировать существующий двоичный файл, установив в него вредоносную функциональность до легитимного исполнения двоичного файла. Например, злоумышленник может изменить точку входа двоичного файла так, чтобы она указывала на вредоносный код, пропатченный злоумышленником, перед возобновлением нормального потока выполнения.

Поскольку такие приложения могут регулярно выполняться пользователем, злоумышленник может использовать это для получения постоянного доступа к хосту.




Внешние удаленные сервисы
-------------------------------------------------


Недоброжелатели могут использовать внешние удаленные службы для первоначального доступа к сети и/или сохранения в ней. Удаленные службы, такие как VPN, Citrix и другие механизмы доступа, позволяют пользователям подключаться к внутренним ресурсам корпоративной сети из внешних мест. Часто существуют шлюзы удаленных служб, которые управляют подключениями и аутентификацией учетных данных для этих служб. Такие службы, как Windows Remote Management и VNC, также могут использоваться извне.

Для использования службы часто требуется доступ к действительным учетным записям, которые могут быть получены с помощью фарминга учетных данных или путем получения учетных данных от пользователей после компрометации корпоративной сети. Доступ к удаленным службам может использоваться в качестве резервного или постоянного механизма доступа во время операции.

Доступ также может быть получен через открытую службу, которая не требует аутентификации. В контейнерных средах это может быть открытый API Docker, API-сервер Kubernetes, kubelet или веб-приложение, такое как панель Kubernetes.



Образы облачных сред
-------------------------------------------------


Злоумышленники могут внедрять в образы облачных сред или контейнеров вредоносный код, чтобы обеспечить постоянство после получения доступа к среде. Образы машин Amazon (AMI) Amazon Web Services (AWS), образы Google Cloud Platform (GCP) и Azure, а также популярные контейнерные режимы, такие как Docker, могут быть имплантированы или заблокированы. В отличие от вредоносного ПО Upload, эта техника направлена на имплантацию образа в реестр в среде жертвы. В зависимости от того, как организована инфраструктура, это может обеспечить постоянный доступ, если инструменту инициализации инфраструктуры дано указание всегда использовать последний образ.

Разработан инструмент для установки бэкдоров в образы контейнеров в облаке. Если у противника есть доступ к взломанному экземпляру AWS и права на список доступных образов контейнеров, он может внедрить бэкдор, например Web Shell.