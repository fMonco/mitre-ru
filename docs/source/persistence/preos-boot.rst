




Загрузка до ОС
=================================


Злоумышленники могут злоупотреблять механизмами предварительной загрузки операционной системы как способом установления постоянства в системе.В процессе загрузки компьютера перед операционной системой загружается встроенное программное обеспечение и различные службы запуска. Эти программы управляют потоком выполнения до того, как операционная система возьмет управление на себя.

Злоумышленники могут перезаписывать данные в загрузочных драйверах или микропрограммах, таких как BIOS (Basic Input/Output System) и The Unified Extensible Firmware Interface (UEFI), чтобы сохраниться в системе на уровне ниже операционной системы. Обнаружить такое ПО бывает особенно сложно, поскольку вредоносные программы на этом уровне не обнаруживаются средствами защиты, основанными на программном обеспечении хоста.




Системная прошивка
-------------------------------------------------


BIOS (Basic Input/Output System) и Unified Extensible Firmware Interface (UEFI) или Extensible Firmware Interface (EFI) являются примерами системных микропрограмм, которые работают как программный интерфейс между операционной системой и аппаратным обеспечением компьютера.   

Системные микропрограммы, такие как BIOS и (U)EFI, обеспечивают функциональность компьютера и могут быть изменены злоумышленником для выполнения или помощи в осуществлении вредоносной деятельности. Существуют возможности перезаписи системной микропрограммы, что может дать искушенным злоумышленникам возможность устанавливать вредоносные обновления микропрограммы в качестве средства сохранения системы, которое трудно обнаружить.




Прошивка компонентов
-------------------------------------------------


Злоумышленники могут модифицировать встроенное программное обеспечение компонентов, чтобы сохранить его в системе. Некоторые злоумышленники могут использовать сложные средства для компрометации компонентов компьютера и установки вредоносной микропрограммы, которая будет выполнять код противника за пределами операционной системы и основной микропрограммы системы или BIOS. Эта техника может быть похожа на системную прошивку, но применяется к другим компонентам/устройствам системы, которые могут не обладать такими же возможностями или уровнем проверки целостности.

Вредоносные микропрограммы компонентов могут обеспечивать постоянный доступ к системам, несмотря на возможные типичные сбои в поддержании доступа и повторные образы жесткого диска, а также позволять обходить защиту и проверки целостности на основе программного обеспечения.




Bootkit
-------------------------------------------------


Вредоносные программы могут использовать буткиты для сохранения своих систем. Буткиты находятся на уровне ниже операционной системы и могут затруднить полное устранение последствий, если организация не подозревает об их использовании и не может действовать соответствующим образом.

Буткит - это вариант вредоносного ПО, который изменяет загрузочные сектора жесткого диска, включая главную загрузочную запись (MBR) и загрузочную запись тома (VBR).  MBR - это раздел диска, который загружается первым после завершения аппаратной инициализации BIOS. На нем располагается загрузчик. Злоумышленник, имеющий необработанный доступ к загрузочному диску, может перезаписать эту область, перенаправив выполнение во время запуска с обычного загрузчика на код злоумышленника. 

MBR передает управление процессом загрузки VBR. Как и в случае с MBR, злоумышленник, имеющий необработанный доступ к загрузочному диску, может перезаписать VBR, чтобы переключить выполнение во время запуска на код злоумышленника.




ROMMONkit
-------------------------------------------------


Злоумышленники могут злоупотреблять ROM Monitor (ROMMON), загружая неавторизованную прошивку с кодом противника, чтобы обеспечить постоянный доступ и манипулировать поведением устройства, которое трудно обнаружить. 

ROMMON - это встроенное программное обеспечение сетевых устройств Cisco, которое функционирует как загрузчик, загрузочный образ или помощник загрузки для инициализации аппаратного и программного обеспечения при включении или перезагрузке платформы. Подобно TFTP Boot, злоумышленник может обновить образ ROMMON локально или удаленно (например, через TFTP) с помощью кода злоумышленника и перезагрузить устройство, чтобы перезаписать существующий образ ROMMON. Это дает злоумышленникам возможность обновлять ROMMON, чтобы добиться устойчивости в системе таким способом, который трудно обнаружить.




Загрузка TFTP
-------------------------------------------------


Злоумышленники могут использовать нетбукинг для загрузки неавторизованной операционной системы сетевого устройства с сервера Trivial File Transfer Protocol (TFTP). Загрузка TFTP (netbooting) обычно используется сетевыми администраторами для загрузки образов сетевых устройств, контролируемых конфигурацией, с централизованного сервера управления. Нетбукинг является одним из вариантов последовательности загрузки и может использоваться для централизации, управления и контроля образов устройств.

Злоумышленники могут манипулировать конфигурацией сетевого устройства, указывая на использование вредоносного TFTP-сервера, который может быть использован в сочетании с Modify System Image для загрузки измененного образа при запуске или перезагрузке устройства. Неавторизованный образ позволяет злоумышленникам изменять конфигурацию устройства, добавлять в него вредоносные возможности и внедрять бэкдоры, чтобы сохранить контроль над сетевым устройством и при этом минимизировать обнаружение за счет использования стандартной функциональности. Эта техника похожа на ROMMONkit и может привести к тому, что на сетевом устройстве будет работать модифицированный образ. 